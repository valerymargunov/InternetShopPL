var BT=BT||{};(function(){BT.Slideshow=new Class({Implements:[Options,Events],options:{},initialize:function(b){this.setOptions(b);var a=JSON.decode(new BT.Base64().base64Decode(this.options.encodedItems));var c=this;this.sortables=new Sortables(this.options.galleryContainer,{clone:true,revert:true,opacity:0.3,onStart:function(e,f){f.setStyle("z-index",999)}});if(a!=null){a.each(function(e){c.add(e)})}var d=null;if(typeof document.adminForm.onsubmit=="function"){d=document.adminForm.onsubmit}document.adminForm.onsubmit=function(){var e=[];var f=0;$$("#btss-gallery-container li").each(function(g){var h=g.retrieve("item");if(h!=null){e[f]=h;f++}});$("btss-gallery-hidden").set("value",new BT.Base64().base64Encode(JSON.encode(e)));if(d!=null){d()}}},add:function(d){var b=new Element("li",{html:'<img src="'+this.options.liveUrl+"/modules/mod_btslideshow/images/"+this.options.moduleID+"/manager/"+d.file+'" /><a href="javascript:void(0)" class="edit">Edit</a><a href="javascript:void(0)" class="remove">Remove</a>'});var c=this;b.getElement(".edit").addEvent("click",function(){c.edit(b)});b.getElement(".remove").addEvent("click",function(){c.remove(b)});b.store("item",d);var a=$(this.options.galleryContainer);b.set("opacity",0);a.grab(b);b.fade("in");this.sortables.addItems(b)},edit:function(b){var a=new Element("div#btss-dialog",{html:this.options.dialogTemplate});var c=b.retrieve("item");a.getElement("#btss-title").set("value",c.title);a.getElement("#btss-link").set("value",c.link);a.getElement("#btss-desc").set("value",c.desc);a.getElement(".btss-dialog-ok").addEvent("click",function(){c.title=a.getElement("#btss-title").get("value");c.link=a.getElement("#btss-link").get("value");c.desc=a.getElement("#btss-desc").get("value");b.store("item",c);SqueezeBox.close()});a.getElement(".btss-dialog-cancel").addEvent("click",function(){SqueezeBox.close()});SqueezeBox.open(a,{handler:"adopt",size:{x:540,y:220}})},remove:function(a){var b=new Fx.Morph(a);b.start({width:0,height:0,opacity:0}).chain(function(){a.dispose()})},showMessage:function(a,d){var a=$(a);var c=new Element("div.bt-message");c.set("html",d);c.set("opacity",0);a.grab(c,"top");var b=new Fx.Morph(c,{link:"chain"});b.start({opacity:1});setTimeout(function(){b.start({opacity:0,height:0}).chain(function(){c.dispose()})},5000)},removeLog:function(a){$(a).getElements(".qq-upload-list li").each(function(d,b,c){setTimeout(function(){var e=new Fx.Morph(d,{link:"chain"});e.start({height:0,opacity:0}).chain(function(){d.dispose()})},1000)})}})})();